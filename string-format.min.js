(function(e,t){function n(e){if(r[e])return r[e];var n=[],i=/(%%)|(^%|(?=.)%)(?:(\d+)?(?:\.)?(\d+)?)?([a-zA-Z])/,s=0,o,u;if(!e.length)return n;for(;u=i.exec(e);)o={match:u[0],idx:u.index},"%%"===u[0]?o.type="%":(o.arg=s++,o.type=u[5],o.h=[!u[3]&&0!==u[3]?t:parseInt(u[3],10),!u[4]&&0!==u[4]?t:parseInt(u[4],10)]),n.push(o),e=e.substr(u.index+u[0].length);return r[e]=n}var r={};"test"===e.ENV&&(e.PF=n),String.prototype.format=function(){for(var e=this.toString(),t=arguments,r=n(e),i=0,s=0;s<r.length;s++){var o=r[s],u=e.substring(0,i+o.idx),e=e.substring(i+o.idx+o.match.length),a="",f=t[o.arg],l=o.h&&parseInt(o.h[0],10),c=o.h&&parseInt(o.h[1],10);switch(o.type){case"%":a="%";break;case"s":f=f||"",a=l?c?f.substr(l,c):f.substring(0,l):f;break;case"f":f=f||0,c>=0&&(f=f.toFixed(c)),a=f.toString(),l!==0&&f<1&&f>-1&&(a=a.replace(/0\./,"."));break;case"d":case"i":a=f?f.toFixed(0):0}i+=o.idx+a.toString().length,e=u+a+e}return e}})(this)
